name: Test WeCom Notification

on:
  workflow_dispatch: # æ‰‹åŠ¨è§¦å‘

jobs:
  test-notification:
    runs-on: ubuntu-latest
    env:
      WECOM_WEBHOOK_URL: ${{ secrets.WECOM_WEBHOOK_URL }}

    steps:
      - name: Test curl command directly
        run: |
          echo "Testing WeCom notification..."
          echo "Webhook URL: $WECOM_WEBHOOK_URL"
          
          # ä½¿ç”¨æœ€åŸºæœ¬çš„æµ‹è¯•æ¶ˆæ¯
          TEST_MESSAGE='{"msgtype":"markdown","markdown":{"content":"ğŸ“Š **æµ‹è¯•é€šçŸ¥**\n\nè¿™æ˜¯ä¸€æ¡ä» GitHub Actions å‘é€çš„æµ‹è¯•é€šçŸ¥ï¼Œç”¨äºéªŒè¯ä¼ä¸šå¾®ä¿¡ Webhook è¿æ¥ã€‚"}}'
          
          echo "Sending message..."
          curl -v -X POST "$WECOM_WEBHOOK_URL" \
               -H "Content-Type: application/json" \
               -d "$TEST_MESSAGE" 
          
          echo "\nTest complete."