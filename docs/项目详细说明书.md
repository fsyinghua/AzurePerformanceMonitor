# Azure Performance Monitor 项目详细说明书

## 项目概述
Azure Performance Monitor 是一个功能完整的 Azure 云资源管理和监控平台，集成了性能监控、成本分析和 FinOps（云财务管理）工具。该平台提供直观的界面和丰富的数据可视化，帮助用户有效地监控、管理和优化 Azure 云资源。

## 架构设计

```
┌─────────────────────┐    HTTP/REST API    ┌─────────────────────┐
│    Frontend (React) │ ◄──────────────────► │   Backend (Node.js) │
│  TypeScript + Antd  │                      │  Express + Azure SDK│
└─────────────────────┘                      └─────────────────────┘
         │                                        │
         │                Azure Cloud             │
         └────────────────────────────────────────┘
```

## 核心功能模块

### 1. 系统架构与导航
**文件位置**：`frontend/src/App.tsx`, `frontend/src/main.tsx`

**功能说明**：提供系统的主要布局和导航结构，包括侧边栏菜单和路由管理

**实现逻辑**：
- 使用 React Router 进行路由管理
- Ant Design Layout 组件构建现代化的界面框架
- 菜单项配置支持动态渲染和路径匹配
- 侧边栏可折叠，支持导航状态管理

**关键组件**：
- `Layout`：主要布局组件
- `Sider`：侧边栏导航
- `Menu`：菜单项配置
- `NavLink`：路由链接

### 2. 仪表板 (Dashboard)
**文件位置**：`frontend/src/components/Dashboard.tsx`

**功能说明**：提供系统的核心概览，展示关键指标和趋势

**实现逻辑**：
- 集成多个数据源，展示虚拟机总数、月度费用、资源利用率等
- 使用统计卡片 (Statistic) 直观显示关键 KPI
- 通过图表可视化费用趋势和资源分布
- 数据加载时的加载状态处理

**关键组件**：
- `Card`：卡片布局
- `Row/Col`：网格布局
- `Statistic`：统计信息
- `ReactECharts`：图表组件

### 3. Azure 资源管理
**文件位置**：`frontend/src/components/AzureResources.tsx`

**功能说明**：管理和监控 Azure 云资源，特别是虚拟机实例

**实现逻辑**：
- 调用后端 API 获取虚拟机列表
- 提供搜索和状态筛选功能
- 支持虚拟机的基本操作（启动、停止、删除、详情）
- 分页处理大量数据

**关键特性**：
- 实时数据同步
- 搜索和多维度筛选
- 状态标签可视化
- 批量操作支持

### 4. 性能监控
**文件位置**：`frontend/src/components/MetricsMonitoring.tsx`

**功能说明**：监控云资源的性能指标

**实现逻辑**：
- 获取 CPU、内存、网络等性能数据
- 实时数据更新和历史趋势展示
- 自定义时间范围的数据查询
- 多维度性能指标分析

**核心功能**：
- 资源指标实时监控
- 历史性能数据查询
- 自定义时间范围分析
- 性能告警阈值设置

### 5. 成本分析
**文件位置**：`frontend/src/components/CostAnalysis.tsx`

**功能说明**：分析云资源使用成本

**实现逻辑**：
- 从 Azure Cost Management API 获取数据
- 可视化成本趋势和分布
- 按资源组、资源类型分类统计
- 成本对比和分析

**主要特性**：
- 详细的成本细分
- 时间趋势分析
- 资源分组成本统计
- 预算管理

### 6. FinOps 工具包
**文件位置**：`frontend/src/components/FinOpsToolkit.tsx`

**功能说明**：提供云成本优化的完整工具套件

**实现逻辑**：
- 三个核心功能模块集成在单个界面中
- 使用标签页 (Tabs) 组织内容
- 实时数据可视化和分析
- 优化建议智能推荐

**核心子模块**：
- **成本预测**：月度成本趋势预测
- **优化建议**：资源优化推荐
- **节省摘要**：总体节省机会统计

## 后端服务架构

### 1. 核心架构
**文件位置**：`backend/src/index.ts`

**功能说明**：后端服务的入口点和核心配置

**实现逻辑**：
- Express.js 框架初始化
- 中间件配置（CORS、JSON 解析等）
- 健康检查端点
- 路由注册

**关键配置**：
- 跨域支持
- JSON 数据处理
- API 路由分层

### 2. Azure 控制器
**文件位置**：`backend/src/controllers/azureController.ts`

**功能说明**：处理与 Azure 云平台交互的所有 API 请求

**实现逻辑**：
- REST 接口设计
- 模拟数据用于演示
- 错误处理和响应格式化
- 数据返回标准化

**主要 API 端点**：
- `/api/v1/azure/virtual-machines` - 获取虚拟机列表
- `/api/v1/azure/cost-analysis` - 成本分析数据
- `/api/v1/azure/finops/optimization-recommendations` - 优化建议
- `/api/v1/azure/finops/cost-forecast` - 成本预测

### 3. Azure 服务层
**文件位置**：`backend/src/services/azureService.ts`

**功能说明**：封装 Azure SDK 的调用，处理与 Azure 云的直接交互

**实现逻辑**：
- 使用官方 Azure SDK
- 身份验证管理
- 数据格式转换
- 错误处理

**关键服务**：
- `ComputeManagementClient` - 虚拟机管理
- `MonitorClient` - 监控数据
- `CostManagementClient` - 成本管理

### 4. 路由配置
**文件位置**：`backend/src/routes/v1.ts`

**功能说明**：API 版本控制和路由组织

**实现逻辑**：
- 模块化路由结构
- 控制器映射
- API 版本管理

## 数据流程与交互

### 前端到后端
```
React Component → API Service → Backend Route → Controller → Service → Azure SDK
```

### 数据处理流程
1. 前端组件发起数据请求
2. 服务层处理 HTTP 请求
3. 后端路由分发到对应控制器
4. 控制器调用服务层逻辑
5. 服务层与 Azure SDK 交互
6. 数据格式化并返回前端
7. 前端组件更新视图

## 实现特点

### 前端特性
- **响应式设计**：支持各种屏幕尺寸
- **现代组件库**：Ant Design 提供丰富组件
- **数据可视化**：ECharts 和 ReactECharts
- **类型安全**：TypeScript 完整支持

### 后端特性
- **模块化架构**：清晰的代码组织结构
- **模拟数据**：方便演示和开发
- **标准化响应**：统一的数据返回格式
- **错误处理**：完善的异常处理机制

## 部署与运行

### 环境要求
- Node.js 16+
- npm 或 yarn
- Azure 订阅（可选，用于真实数据）

### 安装与启动

1. **安装依赖**
```bash
cd backend && npm install
cd ../frontend && npm install
```

2. **启动服务**
```bash
cd backend && npm run dev
cd frontend && npm run dev
```

3. **访问系统**
```
前端地址: http://localhost:5173
后端 API: http://localhost:3000
```

## 未来扩展

### 功能扩展
- 真实 Azure API 集成
- 用户权限管理
- 告警系统
- 批量操作功能
- 历史数据存储

### 架构优化
- 微服务拆分
- 缓存系统
- 数据持久化
- 监控和日志
- 负载均衡

---
*Azure Performance Monitor - 您的云资源管理和 FinOps 解决方案*
